#!/bin/bash
mkdir webui; cd webui;
export PATH=~/miniconda3/envs/webui/bin:$PATH;
sudo add-apt-repository universe -y > /dev/null;
echo -e "\033[1;35mAdding Universe APT repository to Ubuntu (step 1 of 8) ...\033[0m";
echo -e "\033[1;35mUpdating Ubuntu (step 2 of 8) ...\033[0m";
sudo apt-get update > /dev/null 2>&1;
sudo apt-get upgrade -y > /dev/null 2>&1;
echo -e "\033[1;35mInstalling Aria2 (step 3 of 8) ...\033[0m";
sudo apt-get install aria2 -y > /dev/null;
echo -e "\033[1;35mInstalling build-essential/pkg-config/libglvnd-dev/git (step 4 of 8) ...\033[0m";
sudo apt install build-essential -y > /dev/null 2>&1;
sudo apt install pkg-config > /dev/null 2>&1;
sudo apt install libglvnd-dev -y > /dev/null 2>&1;
echo -e "\033[32mCloning Text Generation WebUI from Oobabooga (step 5 of 8) ...\033[0m";
git clone https://github.com/oobabooga/text-generation-webui.git > /dev/null 2>&1;
cd text-generation-webui;
echo -e "\033[1;32mFixing Text Generation WebUI to an older version (step 6 of 8) ...\033[0m";
git reset --hard 72a89e8fd14aa152cf0b373cac738eff6f87dae2 > /dev/null 2>&1;
echo -e "\033[1;33mDownloading Nvidia drivers (step 7 of 8) ...\033[0m";
wget https://download.nvidia.com/XFree86/Linux-x86_64/530.41.03/NVIDIA-Linux-x86_64-530.41.03.run > /dev/null 2>&1;
echo -e "\033[1;34mInstalling NVIDIA driver (without CUDA) and rebooting, next step after login 'cd fast_txtgen && ./install' (step 8 of 8) ...\033[0m";
sudo sh NVIDIA-Linux-x86_64-530.41.03.run -s > /dev/null 2>&1;
echo -e "\033[1;35mAll done, rebooting ...\033[0m";
rm -r *.run && sleep 3;
